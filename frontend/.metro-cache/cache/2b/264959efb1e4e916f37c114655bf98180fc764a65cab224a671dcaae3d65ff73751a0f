{"dependencies":[{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\";\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _react = require(_dependencyMap[0], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[1], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[2], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const BACKEND_URL = process.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthProvider = ({\n    children\n  }) => {\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (!token) {\n          setIsLoading(false);\n          return;\n        }\n        const response = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (response.ok) {\n          const userData = await response.json();\n          setUser(userData);\n        } else {\n          await AsyncStorage.default.removeItem('session_token');\n          setUser(null);\n        }\n      } catch (error) {\n        console.error('Auth check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    const login = async sessionId => {\n      try {\n        const response = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'X-Session-ID': sessionId\n          }\n        });\n        if (!response.ok) {\n          throw new Error('Failed to create session');\n        }\n        const data = await response.json();\n\n        // Extract session_token from response\n        const sessionToken = data.session_token;\n        if (sessionToken) {\n          await AsyncStorage.default.setItem('session_token', sessionToken);\n        }\n\n        // Remove session_token from user data before setting\n        const {\n          session_token,\n          ...userData\n        } = data;\n        setUser(userData);\n      } catch (error) {\n        console.error('Login failed:', error);\n        throw error;\n      }\n    };\n    const logout = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          await fetch(`${BACKEND_URL}/api/auth/logout`, {\n            method: 'POST',\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n        }\n      } catch (error) {\n        console.error('Logout failed:', error);\n      } finally {\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      }\n    };\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }, this);\n  };\n  const useAuth = () => {\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n});","lineCount":136,"map":[[13,2,26,0,"Object"],[13,8,26,0],[13,9,26,0,"defineProperty"],[13,23,26,0],[13,24,26,0,"exports"],[13,31,26,0],[14,4,26,0,"enumerable"],[14,14,26,0],[15,4,26,0,"get"],[15,7,26,0],[15,18,26,0,"get"],[15,19,26,0],[16,6,26,0],[16,13,26,0,"AuthProvider"],[16,25,26,0],[17,4,26,0],[18,2,26,0],[19,2,120,0,"Object"],[19,8,120,0],[19,9,120,0,"defineProperty"],[19,23,120,0],[19,24,120,0,"exports"],[19,31,120,0],[20,4,120,0,"enumerable"],[20,14,120,0],[21,4,120,0,"get"],[21,7,120,0],[21,18,120,0,"get"],[21,19,120,0],[22,6,120,0],[22,13,120,0,"useAuth"],[22,20,120,0],[23,4,120,0],[24,2,120,0],[25,2,1,0],[25,6,1,0,"_react"],[25,12,1,0],[25,15,1,0,"require"],[25,22,1,0],[25,23,1,0,"_dependencyMap"],[25,37,1,0],[26,2,2,0],[26,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[26,42,2,0],[26,45,2,0,"require"],[26,52,2,0],[26,53,2,0,"_dependencyMap"],[26,67,2,0],[27,2,2,0],[27,6,2,0,"AsyncStorage"],[27,18,2,0],[27,21,2,0,"_interopDefault"],[27,36,2,0],[27,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[27,73,2,0],[28,2,2,69],[28,6,2,69,"_reactJsxDevRuntime"],[28,25,2,69],[28,28,2,69,"require"],[28,35,2,69],[28,36,2,69,"_dependencyMap"],[28,50,2,69],[29,2,22,0],[29,8,22,6,"AuthContext"],[29,19,22,17],[29,35,22,20],[29,39,22,20,"createContext"],[29,45,22,33],[29,46,22,33,"createContext"],[29,59,22,33],[29,61,22,63,"undefined"],[29,70,22,72],[29,71,22,73],[30,2,24,0],[30,8,24,6,"BACKEND_URL"],[30,19,24,17],[30,22,24,20,"process"],[30,29,24,27],[30,30,24,28,"env"],[30,33,24,31],[30,34,24,32,"EXPO_PUBLIC_BACKEND_URL"],[30,57,24,55],[31,2,26,7],[31,8,26,13,"AuthProvider"],[31,20,26,66],[31,23,26,69,"AuthProvider"],[31,24,26,70],[32,4,26,72,"children"],[33,2,26,81],[33,3,26,82],[33,8,26,87],[34,4,27,2],[34,10,27,8],[34,11,27,9,"user"],[34,15,27,13],[34,17,27,15,"setUser"],[34,24,27,22],[34,25,27,23],[34,28,27,26],[34,32,27,26,"useState"],[34,38,27,34],[34,39,27,34,"useState"],[34,47,27,34],[34,49,27,48],[34,53,27,52],[34,54,27,53],[35,4,28,2],[35,10,28,8],[35,11,28,9,"isLoading"],[35,20,28,18],[35,22,28,20,"setIsLoading"],[35,34,28,32],[35,35,28,33],[35,38,28,36],[35,42,28,36,"useState"],[35,48,28,44],[35,49,28,44,"useState"],[35,57,28,44],[35,59,28,45],[35,63,28,49],[35,64,28,50],[36,4,30,2],[36,10,30,8,"checkAuth"],[36,19,30,17],[36,22,30,20],[36,26,30,20,"useCallback"],[36,32,30,31],[36,33,30,31,"useCallback"],[36,44,30,31],[36,46,30,32],[36,58,30,44],[37,6,31,4],[37,10,31,8],[38,8,32,6],[38,14,32,12,"token"],[38,19,32,17],[38,22,32,20],[38,28,32,26,"AsyncStorage"],[38,40,32,38],[38,41,32,38,"default"],[38,48,32,38],[38,49,32,39,"getItem"],[38,56,32,46],[38,57,32,47],[38,72,32,62],[38,73,32,63],[39,8,33,6],[39,12,33,10],[39,13,33,11,"token"],[39,18,33,16],[39,20,33,18],[40,10,34,8,"setIsLoading"],[40,22,34,20],[40,23,34,21],[40,28,34,26],[40,29,34,27],[41,10,35,8],[42,8,36,6],[43,8,38,6],[43,14,38,12,"response"],[43,22,38,20],[43,25,38,23],[43,31,38,29,"fetch"],[43,36,38,34],[43,37,38,35],[43,40,38,38,"BACKEND_URL"],[43,51,38,49],[43,65,38,63],[43,67,38,65],[44,10,39,8,"headers"],[44,17,39,15],[44,19,39,17],[45,12,40,10],[45,27,40,25],[45,29,40,27],[45,39,40,37,"token"],[45,44,40,42],[46,10,41,8],[47,8,42,6],[47,9,42,7],[47,10,42,8],[48,8,44,6],[48,12,44,10,"response"],[48,20,44,18],[48,21,44,19,"ok"],[48,23,44,21],[48,25,44,23],[49,10,45,8],[49,16,45,14,"userData"],[49,24,45,22],[49,27,45,25],[49,33,45,31,"response"],[49,41,45,39],[49,42,45,40,"json"],[49,46,45,44],[49,47,45,45],[49,48,45,46],[50,10,46,8,"setUser"],[50,17,46,15],[50,18,46,16,"userData"],[50,26,46,24],[50,27,46,25],[51,8,47,6],[51,9,47,7],[51,15,47,13],[52,10,48,8],[52,16,48,14,"AsyncStorage"],[52,28,48,26],[52,29,48,26,"default"],[52,36,48,26],[52,37,48,27,"removeItem"],[52,47,48,37],[52,48,48,38],[52,63,48,53],[52,64,48,54],[53,10,49,8,"setUser"],[53,17,49,15],[53,18,49,16],[53,22,49,20],[53,23,49,21],[54,8,50,6],[55,6,51,4],[55,7,51,5],[55,8,51,6],[55,15,51,13,"error"],[55,20,51,18],[55,22,51,20],[56,8,52,6,"console"],[56,15,52,13],[56,16,52,14,"error"],[56,21,52,19],[56,22,52,20],[56,42,52,40],[56,44,52,42,"error"],[56,49,52,47],[56,50,52,48],[57,8,53,6],[57,14,53,12,"AsyncStorage"],[57,26,53,24],[57,27,53,24,"default"],[57,34,53,24],[57,35,53,25,"removeItem"],[57,45,53,35],[57,46,53,36],[57,61,53,51],[57,62,53,52],[58,8,54,6,"setUser"],[58,15,54,13],[58,16,54,14],[58,20,54,18],[58,21,54,19],[59,6,55,4],[59,7,55,5],[59,16,55,14],[60,8,56,6,"setIsLoading"],[60,20,56,18],[60,21,56,19],[60,26,56,24],[60,27,56,25],[61,6,57,4],[62,4,58,2],[62,5,58,3],[62,7,58,5],[62,9,58,7],[62,10,58,8],[63,4,60,2],[63,10,60,8,"login"],[63,15,60,13],[63,18,60,16],[63,24,60,23,"sessionId"],[63,33,60,40],[63,37,60,45],[64,6,61,4],[64,10,61,8],[65,8,62,6],[65,14,62,12,"response"],[65,22,62,20],[65,25,62,23],[65,31,62,29,"fetch"],[65,36,62,34],[65,37,62,35],[65,40,62,38,"BACKEND_URL"],[65,51,62,49],[65,70,62,68],[65,72,62,70],[66,10,63,8,"method"],[66,16,63,14],[66,18,63,16],[66,24,63,22],[67,10,64,8,"headers"],[67,17,64,15],[67,19,64,17],[68,12,65,10],[68,26,65,24],[68,28,65,26,"sessionId"],[69,10,66,8],[70,8,67,6],[70,9,67,7],[70,10,67,8],[71,8,69,6],[71,12,69,10],[71,13,69,11,"response"],[71,21,69,19],[71,22,69,20,"ok"],[71,24,69,22],[71,26,69,24],[72,10,70,8],[72,16,70,14],[72,20,70,18,"Error"],[72,25,70,23],[72,26,70,24],[72,52,70,50],[72,53,70,51],[73,8,71,6],[74,8,73,6],[74,14,73,12,"data"],[74,18,73,16],[74,21,73,19],[74,27,73,25,"response"],[74,35,73,33],[74,36,73,34,"json"],[74,40,73,38],[74,41,73,39],[74,42,73,40],[76,8,75,6],[77,8,76,6],[77,14,76,12,"sessionToken"],[77,26,76,24],[77,29,76,27,"data"],[77,33,76,31],[77,34,76,32,"session_token"],[77,47,76,45],[78,8,77,6],[78,12,77,10,"sessionToken"],[78,24,77,22],[78,26,77,24],[79,10,78,8],[79,16,78,14,"AsyncStorage"],[79,28,78,26],[79,29,78,26,"default"],[79,36,78,26],[79,37,78,27,"setItem"],[79,44,78,34],[79,45,78,35],[79,60,78,50],[79,62,78,52,"sessionToken"],[79,74,78,64],[79,75,78,65],[80,8,79,6],[82,8,81,6],[83,8,82,6],[83,14,82,12],[84,10,82,14,"session_token"],[84,23,82,27],[85,10,82,29],[85,13,82,32,"userData"],[86,8,82,41],[86,9,82,42],[86,12,82,45,"data"],[86,16,82,49],[87,8,83,6,"setUser"],[87,15,83,13],[87,16,83,14,"userData"],[87,24,83,22],[87,25,83,23],[88,6,84,4],[88,7,84,5],[88,8,84,6],[88,15,84,13,"error"],[88,20,84,18],[88,22,84,20],[89,8,85,6,"console"],[89,15,85,13],[89,16,85,14,"error"],[89,21,85,19],[89,22,85,20],[89,37,85,35],[89,39,85,37,"error"],[89,44,85,42],[89,45,85,43],[90,8,86,6],[90,14,86,12,"error"],[90,19,86,17],[91,6,87,4],[92,4,88,2],[92,5,88,3],[93,4,90,2],[93,10,90,8,"logout"],[93,16,90,14],[93,19,90,17],[93,25,90,17,"logout"],[93,26,90,17],[93,31,90,29],[94,6,91,4],[94,10,91,8],[95,8,92,6],[95,14,92,12,"token"],[95,19,92,17],[95,22,92,20],[95,28,92,26,"AsyncStorage"],[95,40,92,38],[95,41,92,38,"default"],[95,48,92,38],[95,49,92,39,"getItem"],[95,56,92,46],[95,57,92,47],[95,72,92,62],[95,73,92,63],[96,8,93,6],[96,12,93,10,"token"],[96,17,93,15],[96,19,93,17],[97,10,94,8],[97,16,94,14,"fetch"],[97,21,94,19],[97,22,94,20],[97,25,94,23,"BACKEND_URL"],[97,36,94,34],[97,54,94,52],[97,56,94,54],[98,12,95,10,"method"],[98,18,95,16],[98,20,95,18],[98,26,95,24],[99,12,96,10,"headers"],[99,19,96,17],[99,21,96,19],[100,14,97,12],[100,29,97,27],[100,31,97,29],[100,41,97,39,"token"],[100,46,97,44],[101,12,98,10],[102,10,99,8],[102,11,99,9],[102,12,99,10],[103,8,100,6],[104,6,101,4],[104,7,101,5],[104,8,101,6],[104,15,101,13,"error"],[104,20,101,18],[104,22,101,20],[105,8,102,6,"console"],[105,15,102,13],[105,16,102,14,"error"],[105,21,102,19],[105,22,102,20],[105,38,102,36],[105,40,102,38,"error"],[105,45,102,43],[105,46,102,44],[106,6,103,4],[106,7,103,5],[106,16,103,14],[107,8,104,6],[107,14,104,12,"AsyncStorage"],[107,26,104,24],[107,27,104,24,"default"],[107,34,104,24],[107,35,104,25,"removeItem"],[107,45,104,35],[107,46,104,36],[107,61,104,51],[107,62,104,52],[108,8,105,6,"setUser"],[108,15,105,13],[108,16,105,14],[108,20,105,18],[108,21,105,19],[109,6,106,4],[110,4,107,2],[110,5,107,3],[111,4,109,2],[111,8,109,2,"useEffect"],[111,14,109,11],[111,15,109,11,"useEffect"],[111,24,109,11],[111,26,109,12],[111,32,109,18],[112,6,110,4,"checkAuth"],[112,15,110,13],[112,16,110,14],[112,17,110,15],[113,4,111,2],[113,5,111,3],[113,7,111,5],[113,8,111,6,"checkAuth"],[113,17,111,15],[113,18,111,16],[113,19,111,17],[114,4,113,2],[114,24,114,4],[114,28,114,4,"_reactJsxDevRuntime"],[114,47,114,4],[114,48,114,4,"jsxDEV"],[114,54,114,4],[114,56,114,5,"AuthContext"],[114,67,114,16],[114,68,114,17,"Provider"],[114,76,114,25],[115,6,114,26,"value"],[115,11,114,31],[115,13,114,33],[116,8,114,35,"user"],[116,12,114,39],[117,8,114,41,"isLoading"],[117,17,114,50],[118,8,114,52,"login"],[118,13,114,57],[119,8,114,59,"logout"],[119,14,114,65],[120,8,114,67,"checkAuth"],[121,6,114,77],[121,7,114,79],[122,6,114,79,"children"],[122,14,114,79],[122,16,115,7,"children"],[123,4,115,15],[124,6,115,15,"fileName"],[124,14,115,15],[124,16,115,15,"_jsxFileName"],[124,28,115,15],[125,6,115,15,"lineNumber"],[125,16,115,15],[126,6,115,15,"columnNumber"],[126,18,115,15],[127,4,115,15],[127,11,116,26],[127,12,116,27],[128,2,118,0],[128,3,118,1],[129,2,120,7],[129,8,120,13,"useAuth"],[129,15,120,20],[129,18,120,23,"useAuth"],[129,19,120,23],[129,24,120,29],[130,4,121,2],[130,10,121,8,"context"],[130,17,121,15],[130,20,121,18],[130,24,121,18,"useContext"],[130,30,121,28],[130,31,121,28,"useContext"],[130,41,121,28],[130,43,121,29,"AuthContext"],[130,54,121,40],[130,55,121,41],[131,4,122,2],[131,8,122,6,"context"],[131,15,122,13],[131,20,122,18,"undefined"],[131,29,122,27],[131,31,122,29],[132,6,123,4],[132,12,123,10],[132,16,123,14,"Error"],[132,21,123,19],[132,22,123,20],[132,67,123,65],[132,68,123,66],[133,4,124,2],[134,4,125,2],[134,11,125,9,"context"],[134,18,125,16],[135,2,126,0],[135,3,126,1],[136,0,126,2],[136,3]],"functionMap":{"names":["<global>","AuthProvider","checkAuth","login","logout","useEffect$argument_0","useAuth"],"mappings":"AAA;qECyB;gCCI;GD4B;gBEE;GF4B;iBGE;GHiB;YIE;GJE;CDO;uBME;CNM"},"hasCjsExports":false},"type":"js/module"}]}