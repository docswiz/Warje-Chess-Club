{"dependencies":[{"name":"@babel/runtime/helpers/objectWithoutPropertiesLoose","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"HFkXuFcBAqfzGtqyPj8g62MKT0M=","exportNames":["*"],"imports":1}},{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}},{"name":"react","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":91,"index":91}}],"key":"RtGiGa+/H7VrI7GDQDLhO1UbpU8=","exportNames":["*"],"imports":1}},{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":92},"end":{"line":2,"column":69,"index":161}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"react/jsx-dev-runtime","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"L9D70Z4hi4aGuui1ysja/oQ5ytI=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  const _excluded = [\"session_token\"];\n  var _jsxFileName = \"/app/frontend/contexts/AuthContext.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"AuthProvider\", {\n    enumerable: true,\n    get: function () {\n      return AuthProvider;\n    }\n  });\n  Object.defineProperty(exports, \"useAuth\", {\n    enumerable: true,\n    get: function () {\n      return useAuth;\n    }\n  });\n  var _babelRuntimeHelpersObjectWithoutPropertiesLoose = require(_dependencyMap[0], \"@babel/runtime/helpers/objectWithoutPropertiesLoose\");\n  var _objectWithoutPropertiesLoose = _interopDefault(_babelRuntimeHelpersObjectWithoutPropertiesLoose);\n  var _expoVirtualEnv = require(_dependencyMap[1], \"expo/virtual/env\");\n  var _react = require(_dependencyMap[2], \"react\");\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[3], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _reactJsxDevRuntime = require(_dependencyMap[4], \"react/jsx-dev-runtime\");\n  const AuthContext = /*#__PURE__*/(0, _react.createContext)(undefined);\n  const BACKEND_URL = _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL;\n  const AuthProvider = ({\n    children\n  }) => {\n    _s();\n    const [user, setUser] = (0, _react.useState)(null);\n    const [isLoading, setIsLoading] = (0, _react.useState)(true);\n    const checkAuth = (0, _react.useCallback)(async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (!token) {\n          setIsLoading(false);\n          return;\n        }\n        const response = await fetch(`${BACKEND_URL}/api/auth/me`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        if (response.ok) {\n          const userData = await response.json();\n          setUser(userData);\n        } else {\n          await AsyncStorage.default.removeItem('session_token');\n          setUser(null);\n        }\n      } catch (error) {\n        console.error('Auth check failed:', error);\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      } finally {\n        setIsLoading(false);\n      }\n    }, []);\n    const login = async sessionId => {\n      try {\n        const response = await fetch(`${BACKEND_URL}/api/auth/session`, {\n          method: 'POST',\n          headers: {\n            'X-Session-ID': sessionId\n          }\n        });\n        if (!response.ok) {\n          throw new Error('Failed to create session');\n        }\n        const data = await response.json();\n\n        // Extract session_token from response\n        const sessionToken = data.session_token;\n        if (sessionToken) {\n          await AsyncStorage.default.setItem('session_token', sessionToken);\n        }\n\n        // Remove session_token from user data before setting\n        const userData = (0, _objectWithoutPropertiesLoose.default)(data, _excluded);\n        setUser(userData);\n      } catch (error) {\n        console.error('Login failed:', error);\n        throw error;\n      }\n    };\n    const logout = async () => {\n      try {\n        const token = await AsyncStorage.default.getItem('session_token');\n        if (token) {\n          await fetch(`${BACKEND_URL}/api/auth/logout`, {\n            method: 'POST',\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n        }\n      } catch (error) {\n        console.error('Logout failed:', error);\n      } finally {\n        await AsyncStorage.default.removeItem('session_token');\n        setUser(null);\n      }\n    };\n    (0, _react.useEffect)(() => {\n      checkAuth();\n    }, [checkAuth]);\n    return /*#__PURE__*/(0, _reactJsxDevRuntime.jsxDEV)(AuthContext.Provider, {\n      value: {\n        user,\n        isLoading,\n        login,\n        logout,\n        checkAuth\n      },\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 5\n    }, this);\n  };\n  _s(AuthProvider, \"UXO0MW8OFT5jrQH1+T8ZTvU2qWA=\");\n  _c = AuthProvider;\n  const useAuth = () => {\n    _s2();\n    const context = (0, _react.useContext)(AuthContext);\n    if (context === undefined) {\n      throw new Error('useAuth must be used within an AuthProvider');\n    }\n    return context;\n  };\n  _s2(useAuth, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\n  var _c;\n  $RefreshReg$(_c, \"AuthProvider\");\n});","lineCount":146,"map":[[16,2,26,0,"Object"],[16,8,26,0],[16,9,26,0,"defineProperty"],[16,23,26,0],[16,24,26,0,"exports"],[16,31,26,0],[17,4,26,0,"enumerable"],[17,14,26,0],[18,4,26,0,"get"],[18,7,26,0],[18,18,26,0,"get"],[18,19,26,0],[19,6,26,0],[19,13,26,0,"AuthProvider"],[19,25,26,0],[20,4,26,0],[21,2,26,0],[22,2,120,0,"Object"],[22,8,120,0],[22,9,120,0,"defineProperty"],[22,23,120,0],[22,24,120,0,"exports"],[22,31,120,0],[23,4,120,0,"enumerable"],[23,14,120,0],[24,4,120,0,"get"],[24,7,120,0],[24,18,120,0,"get"],[24,19,120,0],[25,6,120,0],[25,13,120,0,"useAuth"],[25,20,120,0],[26,4,120,0],[27,2,120,0],[28,2,126,2],[28,6,126,2,"_babelRuntimeHelpersObjectWithoutPropertiesLoose"],[28,54,126,2],[28,57,126,2,"require"],[28,64,126,2],[28,65,126,2,"_dependencyMap"],[28,79,126,2],[29,2,126,2],[29,6,126,2,"_objectWithoutPropertiesLoose"],[29,35,126,2],[29,38,126,2,"_interopDefault"],[29,53,126,2],[29,54,126,2,"_babelRuntimeHelpersObjectWithoutPropertiesLoose"],[29,102,126,2],[30,2,126,2],[30,6,126,2,"_expoVirtualEnv"],[30,21,126,2],[30,24,126,2,"require"],[30,31,126,2],[30,32,126,2,"_dependencyMap"],[30,46,126,2],[31,2,1,0],[31,6,1,0,"_react"],[31,12,1,0],[31,15,1,0,"require"],[31,22,1,0],[31,23,1,0,"_dependencyMap"],[31,37,1,0],[32,2,2,0],[32,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[32,42,2,0],[32,45,2,0,"require"],[32,52,2,0],[32,53,2,0,"_dependencyMap"],[32,67,2,0],[33,2,2,0],[33,6,2,0,"AsyncStorage"],[33,18,2,0],[33,21,2,0,"_interopDefault"],[33,36,2,0],[33,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[33,73,2,0],[34,2,2,69],[34,6,2,69,"_reactJsxDevRuntime"],[34,25,2,69],[34,28,2,69,"require"],[34,35,2,69],[34,36,2,69,"_dependencyMap"],[34,50,2,69],[35,2,22,0],[35,8,22,6,"AuthContext"],[35,19,22,17],[35,35,22,20],[35,39,22,20,"createContext"],[35,45,22,33],[35,46,22,33,"createContext"],[35,59,22,33],[35,61,22,63,"undefined"],[35,70,22,72],[35,71,22,73],[36,2,24,0],[36,8,24,6,"BACKEND_URL"],[36,19,24,17],[36,22,24,17,"_expoVirtualEnv"],[36,37,24,17],[36,38,24,17,"env"],[36,41,24,17],[36,42,24,17,"EXPO_PUBLIC_BACKEND_URL"],[36,65,24,55],[37,2,26,7],[37,8,26,13,"AuthProvider"],[37,20,26,66],[37,23,26,69,"AuthProvider"],[37,24,26,70],[38,4,26,72,"children"],[39,2,26,81],[39,3,26,82],[39,8,26,87],[40,4,26,87,"_s"],[40,6,26,87],[41,4,27,2],[41,10,27,8],[41,11,27,9,"user"],[41,15,27,13],[41,17,27,15,"setUser"],[41,24,27,22],[41,25,27,23],[41,28,27,26],[41,32,27,26,"useState"],[41,38,27,34],[41,39,27,34,"useState"],[41,47,27,34],[41,49,27,48],[41,53,27,52],[41,54,27,53],[42,4,28,2],[42,10,28,8],[42,11,28,9,"isLoading"],[42,20,28,18],[42,22,28,20,"setIsLoading"],[42,34,28,32],[42,35,28,33],[42,38,28,36],[42,42,28,36,"useState"],[42,48,28,44],[42,49,28,44,"useState"],[42,57,28,44],[42,59,28,45],[42,63,28,49],[42,64,28,50],[43,4,30,2],[43,10,30,8,"checkAuth"],[43,19,30,17],[43,22,30,20],[43,26,30,20,"useCallback"],[43,32,30,31],[43,33,30,31,"useCallback"],[43,44,30,31],[43,46,30,32],[43,58,30,44],[44,6,31,4],[44,10,31,8],[45,8,32,6],[45,14,32,12,"token"],[45,19,32,17],[45,22,32,20],[45,28,32,26,"AsyncStorage"],[45,40,32,38],[45,41,32,38,"default"],[45,48,32,38],[45,49,32,39,"getItem"],[45,56,32,46],[45,57,32,47],[45,72,32,62],[45,73,32,63],[46,8,33,6],[46,12,33,10],[46,13,33,11,"token"],[46,18,33,16],[46,20,33,18],[47,10,34,8,"setIsLoading"],[47,22,34,20],[47,23,34,21],[47,28,34,26],[47,29,34,27],[48,10,35,8],[49,8,36,6],[50,8,38,6],[50,14,38,12,"response"],[50,22,38,20],[50,25,38,23],[50,31,38,29,"fetch"],[50,36,38,34],[50,37,38,35],[50,40,38,38,"BACKEND_URL"],[50,51,38,49],[50,65,38,63],[50,67,38,65],[51,10,39,8,"headers"],[51,17,39,15],[51,19,39,17],[52,12,40,10],[52,27,40,25],[52,29,40,27],[52,39,40,37,"token"],[52,44,40,42],[53,10,41,8],[54,8,42,6],[54,9,42,7],[54,10,42,8],[55,8,44,6],[55,12,44,10,"response"],[55,20,44,18],[55,21,44,19,"ok"],[55,23,44,21],[55,25,44,23],[56,10,45,8],[56,16,45,14,"userData"],[56,24,45,22],[56,27,45,25],[56,33,45,31,"response"],[56,41,45,39],[56,42,45,40,"json"],[56,46,45,44],[56,47,45,45],[56,48,45,46],[57,10,46,8,"setUser"],[57,17,46,15],[57,18,46,16,"userData"],[57,26,46,24],[57,27,46,25],[58,8,47,6],[58,9,47,7],[58,15,47,13],[59,10,48,8],[59,16,48,14,"AsyncStorage"],[59,28,48,26],[59,29,48,26,"default"],[59,36,48,26],[59,37,48,27,"removeItem"],[59,47,48,37],[59,48,48,38],[59,63,48,53],[59,64,48,54],[60,10,49,8,"setUser"],[60,17,49,15],[60,18,49,16],[60,22,49,20],[60,23,49,21],[61,8,50,6],[62,6,51,4],[62,7,51,5],[62,8,51,6],[62,15,51,13,"error"],[62,20,51,18],[62,22,51,20],[63,8,52,6,"console"],[63,15,52,13],[63,16,52,14,"error"],[63,21,52,19],[63,22,52,20],[63,42,52,40],[63,44,52,42,"error"],[63,49,52,47],[63,50,52,48],[64,8,53,6],[64,14,53,12,"AsyncStorage"],[64,26,53,24],[64,27,53,24,"default"],[64,34,53,24],[64,35,53,25,"removeItem"],[64,45,53,35],[64,46,53,36],[64,61,53,51],[64,62,53,52],[65,8,54,6,"setUser"],[65,15,54,13],[65,16,54,14],[65,20,54,18],[65,21,54,19],[66,6,55,4],[66,7,55,5],[66,16,55,14],[67,8,56,6,"setIsLoading"],[67,20,56,18],[67,21,56,19],[67,26,56,24],[67,27,56,25],[68,6,57,4],[69,4,58,2],[69,5,58,3],[69,7,58,5],[69,9,58,7],[69,10,58,8],[70,4,60,2],[70,10,60,8,"login"],[70,15,60,13],[70,18,60,16],[70,24,60,23,"sessionId"],[70,33,60,40],[70,37,60,45],[71,6,61,4],[71,10,61,8],[72,8,62,6],[72,14,62,12,"response"],[72,22,62,20],[72,25,62,23],[72,31,62,29,"fetch"],[72,36,62,34],[72,37,62,35],[72,40,62,38,"BACKEND_URL"],[72,51,62,49],[72,70,62,68],[72,72,62,70],[73,10,63,8,"method"],[73,16,63,14],[73,18,63,16],[73,24,63,22],[74,10,64,8,"headers"],[74,17,64,15],[74,19,64,17],[75,12,65,10],[75,26,65,24],[75,28,65,26,"sessionId"],[76,10,66,8],[77,8,67,6],[77,9,67,7],[77,10,67,8],[78,8,69,6],[78,12,69,10],[78,13,69,11,"response"],[78,21,69,19],[78,22,69,20,"ok"],[78,24,69,22],[78,26,69,24],[79,10,70,8],[79,16,70,14],[79,20,70,18,"Error"],[79,25,70,23],[79,26,70,24],[79,52,70,50],[79,53,70,51],[80,8,71,6],[81,8,73,6],[81,14,73,12,"data"],[81,18,73,16],[81,21,73,19],[81,27,73,25,"response"],[81,35,73,33],[81,36,73,34,"json"],[81,40,73,38],[81,41,73,39],[81,42,73,40],[83,8,75,6],[84,8,76,6],[84,14,76,12,"sessionToken"],[84,26,76,24],[84,29,76,27,"data"],[84,33,76,31],[84,34,76,32,"session_token"],[84,47,76,45],[85,8,77,6],[85,12,77,10,"sessionToken"],[85,24,77,22],[85,26,77,24],[86,10,78,8],[86,16,78,14,"AsyncStorage"],[86,28,78,26],[86,29,78,26,"default"],[86,36,78,26],[86,37,78,27,"setItem"],[86,44,78,34],[86,45,78,35],[86,60,78,50],[86,62,78,52,"sessionToken"],[86,74,78,64],[86,75,78,65],[87,8,79,6],[89,8,81,6],[90,8,82,6],[90,14,82,32,"userData"],[90,22,82,40],[90,29,82,40,"_objectWithoutPropertiesLoose"],[90,58,82,40],[90,59,82,40,"default"],[90,66,82,40],[90,68,82,45,"data"],[90,72,82,49],[90,74,82,49,"_excluded"],[90,83,82,49],[91,8,83,6,"setUser"],[91,15,83,13],[91,16,83,14,"userData"],[91,24,83,22],[91,25,83,23],[92,6,84,4],[92,7,84,5],[92,8,84,6],[92,15,84,13,"error"],[92,20,84,18],[92,22,84,20],[93,8,85,6,"console"],[93,15,85,13],[93,16,85,14,"error"],[93,21,85,19],[93,22,85,20],[93,37,85,35],[93,39,85,37,"error"],[93,44,85,42],[93,45,85,43],[94,8,86,6],[94,14,86,12,"error"],[94,19,86,17],[95,6,87,4],[96,4,88,2],[96,5,88,3],[97,4,90,2],[97,10,90,8,"logout"],[97,16,90,14],[97,19,90,17],[97,25,90,17,"logout"],[97,26,90,17],[97,31,90,29],[98,6,91,4],[98,10,91,8],[99,8,92,6],[99,14,92,12,"token"],[99,19,92,17],[99,22,92,20],[99,28,92,26,"AsyncStorage"],[99,40,92,38],[99,41,92,38,"default"],[99,48,92,38],[99,49,92,39,"getItem"],[99,56,92,46],[99,57,92,47],[99,72,92,62],[99,73,92,63],[100,8,93,6],[100,12,93,10,"token"],[100,17,93,15],[100,19,93,17],[101,10,94,8],[101,16,94,14,"fetch"],[101,21,94,19],[101,22,94,20],[101,25,94,23,"BACKEND_URL"],[101,36,94,34],[101,54,94,52],[101,56,94,54],[102,12,95,10,"method"],[102,18,95,16],[102,20,95,18],[102,26,95,24],[103,12,96,10,"headers"],[103,19,96,17],[103,21,96,19],[104,14,97,12],[104,29,97,27],[104,31,97,29],[104,41,97,39,"token"],[104,46,97,44],[105,12,98,10],[106,10,99,8],[106,11,99,9],[106,12,99,10],[107,8,100,6],[108,6,101,4],[108,7,101,5],[108,8,101,6],[108,15,101,13,"error"],[108,20,101,18],[108,22,101,20],[109,8,102,6,"console"],[109,15,102,13],[109,16,102,14,"error"],[109,21,102,19],[109,22,102,20],[109,38,102,36],[109,40,102,38,"error"],[109,45,102,43],[109,46,102,44],[110,6,103,4],[110,7,103,5],[110,16,103,14],[111,8,104,6],[111,14,104,12,"AsyncStorage"],[111,26,104,24],[111,27,104,24,"default"],[111,34,104,24],[111,35,104,25,"removeItem"],[111,45,104,35],[111,46,104,36],[111,61,104,51],[111,62,104,52],[112,8,105,6,"setUser"],[112,15,105,13],[112,16,105,14],[112,20,105,18],[112,21,105,19],[113,6,106,4],[114,4,107,2],[114,5,107,3],[115,4,109,2],[115,8,109,2,"useEffect"],[115,14,109,11],[115,15,109,11,"useEffect"],[115,24,109,11],[115,26,109,12],[115,32,109,18],[116,6,110,4,"checkAuth"],[116,15,110,13],[116,16,110,14],[116,17,110,15],[117,4,111,2],[117,5,111,3],[117,7,111,5],[117,8,111,6,"checkAuth"],[117,17,111,15],[117,18,111,16],[117,19,111,17],[118,4,113,2],[118,24,114,4],[118,28,114,4,"_reactJsxDevRuntime"],[118,47,114,4],[118,48,114,4,"jsxDEV"],[118,54,114,4],[118,56,114,5,"AuthContext"],[118,67,114,16],[118,68,114,17,"Provider"],[118,76,114,25],[119,6,114,26,"value"],[119,11,114,31],[119,13,114,33],[120,8,114,35,"user"],[120,12,114,39],[121,8,114,41,"isLoading"],[121,17,114,50],[122,8,114,52,"login"],[122,13,114,57],[123,8,114,59,"logout"],[123,14,114,65],[124,8,114,67,"checkAuth"],[125,6,114,77],[125,7,114,79],[126,6,114,79,"children"],[126,14,114,79],[126,16,115,7,"children"],[127,4,115,15],[128,6,115,15,"fileName"],[128,14,115,15],[128,16,115,15,"_jsxFileName"],[128,28,115,15],[129,6,115,15,"lineNumber"],[129,16,115,15],[130,6,115,15,"columnNumber"],[130,18,115,15],[131,4,115,15],[131,11,116,26],[131,12,116,27],[132,2,118,0],[132,3,118,1],[133,2,118,2,"_s"],[133,4,118,2],[133,5,26,13,"AuthProvider"],[133,17,26,66],[134,2,26,66,"_c"],[134,4,26,66],[134,7,26,13,"AuthProvider"],[134,19,26,66],[135,2,120,7],[135,8,120,13,"useAuth"],[135,15,120,20],[135,18,120,23,"useAuth"],[135,19,120,23],[135,24,120,29],[136,4,120,29,"_s2"],[136,7,120,29],[137,4,121,2],[137,10,121,8,"context"],[137,17,121,15],[137,20,121,18],[137,24,121,18,"useContext"],[137,30,121,28],[137,31,121,28,"useContext"],[137,41,121,28],[137,43,121,29,"AuthContext"],[137,54,121,40],[137,55,121,41],[138,4,122,2],[138,8,122,6,"context"],[138,15,122,13],[138,20,122,18,"undefined"],[138,29,122,27],[138,31,122,29],[139,6,123,4],[139,12,123,10],[139,16,123,14,"Error"],[139,21,123,19],[139,22,123,20],[139,67,123,65],[139,68,123,66],[140,4,124,2],[141,4,125,2],[141,11,125,9,"context"],[141,18,125,16],[142,2,126,0],[142,3,126,1],[143,2,126,2,"_s2"],[143,5,126,2],[143,6,120,13,"useAuth"],[143,13,120,20],[144,2,120,20],[144,6,120,20,"_c"],[144,8,120,20],[145,2,120,20,"$RefreshReg$"],[145,14,120,20],[145,15,120,20,"_c"],[145,17,120,20],[146,0,120,20],[146,3]],"functionMap":{"names":["<global>","AuthProvider","checkAuth","login","logout","useEffect$argument_0","useAuth"],"mappings":"AAA;qECyB;gCCI;GD4B;gBEE;GF4B;iBGE;GHiB;YIE;GJE;CDO;uBME;CNM"},"hasCjsExports":false},"type":"js/module"}]}